---
layout:     post
title:      "以太坊(ethereum)开发"
date:       2018-05-23 05:59:00
tags:   BlockChain
---

> 不适合人类阅读的学习笔记

## 安装Truffle
---
#### Node.js安装

- 先要进行node.js环境的安装，见上一篇博客。

#### 命令行安装truffle

- 执行命令 ` npm install -g truffle`

## 创建工程
---

-  执行命令 `truffle init`

- `init` 之后目录下就会有若干文件和文件夹。结构如下：
![](images/block_chain/structure.png)

- contracts目录中包含Solidity合约代码，其中Migrations.sol是必须有的，其他就是你自己写的合约代码了。

- migrations目录中包含合约部署脚本，其中1_initial_migration.js就是用来部署Migrations.sol的，其他的脚本会按照顺序依次执行。

- test目录中就是测试代码了。

- 官方文档(命令行指令，前面要加truffle)：

```
Commands:
  init      Initialize new and empty Ethereum project
  compile   Compile contract source files
  migrate   Run migrations to deploy contracts
  deploy    (alias for migrate)
  build     Execute build pipeline (if configuration present)
  test      Run JavaScript and Solidity tests
  debug     Interactively debug any transaction on the blockchain (experimental)
  opcode    Print the compiled opcodes for a given contract
  console   Run a console with contract abstractions and commands available
  develop   Open a console with a local development blockchain
  create    Helper to create new contracts, migrations and tests
  install   Install a package from the Ethereum Package Registry
  publish   Publish a package to the Ethereum Package Registry
  networks  Show addresses for deployed contracts on each network
  watch     Watch filesystem for changes and rebuild the project automatically
  serve     Serve the build directory on localhost and watch for changes
  exec      Execute a JS module within this Truffle environment
  unbox     Download a Truffle Box, a pre-built Truffle project
  version   Show version number and exit
See more at http://truffleframework.com/docs

```
终端输入`truffle`即可查看上述命令

## 安装以太坊客户端
---

- 这里我们选择了Ganache——[github项目](https://github.com/trufflesuite/ganache-cli)

- [图形版本下载地址](https://github.com/trufflesuite/ganache/releases)(linux下载 XX.AppImage文件格式的)

- 命令行版本（ganache-cli）下载 `npm install -g ganache-cli`

- Ganache的前身是testRPC

## 编译和部署合约
---

- Ganache默认运行在7545端口，可以在界面右上方的“设置”里进行更改。运行后默认创建10个账号，每个账号里有100ETH的余额。
要部署到链上，需要把IP、端口、网络ID告诉truffle。

- 若要修改，则修改truffle.js：
```
module.exports = {  
    networks: {  
        development: {  
            host: 'localhost',  
            port: '7545',  
            network_id: '*' // Match any network id  
        }  
    }  
};  
```

- 编译和部署命令:
```
truffle compile  
truffle migrate
```

## 测试合约
---

- 直接执行命令：`truffle unbox metacoin `,创建这个项目。

- 由于metacoin的示例代码里已经把测试代码写好了，直接用下面的命令运行就可以了：`truffle test`



<br>
最后更新于2018.5.23
